!function(t){var e={selector:".add-to-calendar",duration:60,texts:{label:"Add to Calendar",title:"New event",download:"Calendar-event.ics",google:"Google Calendar",yahoo:"Yahoo! Calendar",off365:"Office 365",outlkcom:"Outlook.com",ical:"Apple iCalendar",outlook:"Outlook",ienoblob:"Sorry, your browser does not support downloading Calendar events."}};"undefined"!=typeof ADDTOCAL_CONFIG&&(e=ADDTOCAL_CONFIG);var a="msSaveOrOpenBlob"in window.navigator,o=/\b(MSIE |Trident.*?rv:|Edge\/)(\d+)/.exec(navigator.userAgent),n={google:function(t){var a,o,n,d;t.allday?(a=r(t.tzstart),o=r(l(t.tzend,1440)),a=i(a),o=i(o)):t.timezone?(n=new Date(t.start.getTime()-6e4*t.start.getTimezoneOffset()),t.end&&(d=new Date(t.end.getTime()-6e4*t.end.getTimezoneOffset())),a=r(n),o=r(d),a=a.substring(0,a.length-1),o=o.substring(0,o.length-1)):(a=r(t.start),o=r(t.end));return'<a class="icon-google" target="_blank" href="'+encodeURI(["https://www.google.com/calendar/render","?action=TEMPLATE","&text="+(t.title||""),"&dates="+(a||""),"/"+(o||""),t.timezone?"&ctz="+t.timezone:"","&details="+(t.description||""),"&location="+(t.address||""),"&sprop=&sprop=name:"].join(""))+'">'+e.texts.google+"</a>"},yahoo:function(t){var a=r(t.tzstart)||"";if(t.allday)if(i(r(t.tzstart))==i(r(t.tzend)))var o="&dur=allday";else var n="&et="+i(r(l(t.tzend,1440)))||"";else{var d=t.tzend?(t.tzend.getTime()-t.tzstart.getTime())/6e4:t.duration;o="&dur="+(d<600?"0"+Math.floor(d/60):Math.floor(d/60)+"")+(d%60<10?"0"+d%60:d%60+"")}return'<a class="icon-yahoo" target="_blank" href="'+encodeURI(["http://calendar.yahoo.com/?v=60&view=d&type=20","&title="+(t.title||""),"&st="+a,n||"",o||"","&desc="+(t.description||""),"&in_loc="+(t.address||"")].join(""))+'">'+e.texts.yahoo+"</a>"},off365:function(t){var a=r(t.tzstart),o=r(t.tzend),n=t.description||"";do{var d=encodeURI(["https://outlook.office365.com/owa/","?path=/calendar/action/compose","&rru=addevent","&subject="+(t.title||""),"&startdt="+(a||""),"&enddt="+(o||""),"&body="+n,"&location="+(t.address||""),"&allday="+(t.allday?"true":"false")].join(""));d.length>2084&&(n=String(n).replace(/\s.*?$/,""))}while(d.length>2084&&/\s/.test(n));return'<a class="icon-off365" target="_blank" href="'+d+'">'+e.texts.off365+"</a>"},outlkcom:function(t){var a=r(t.tzstart),o=r(t.tzend),n=t.description||"";do{var d=encodeURI(["https://outlook.live.com/owa/","?path=/calendar/action/compose","&rru=addevent","&subject="+(t.title||""),"&startdt="+(a||""),"&enddt="+(o||""),"&body="+n,"&location="+(t.address||""),"&allday="+(t.allday?"true":"false")].join(""));d.length>2084&&(n=String(n).replace(/\s.*?$/,""))}while(d.length>2084&&/\s/.test(n));return'<a class="icon-outlkcom" target="_blank" href="'+d+'">'+e.texts.outlkcom+"</a>"},ics:function(t,a,n){var d,s;if(t.allday){var u=r(t.tzstart),m=r(l(t.tzend,1440));d="DTSTART;VALUE=DATE:"+i(u),s="DTEND;VALUE=DATE:"+i(m)}else d="DTSTART:"+r(t.tzstart),s="DTEND:"+r(t.tzend);var p=["BEGIN:VCALENDAR","VERSION:2.0","BEGIN:VEVENT","URL:"+document.URL,d,s,"SUMMARY:"+(t.title||""),"DESCRIPTION:"+(t.description?String(t.description).replace(/[\r\n]/g,"\\n"):""),"LOCATION:"+(t.address||""),"UID:"+(t.id||"")+"-"+document.URL,"END:VEVENT","END:VCALENDAR"].join("\n");if(o)return'<a class="'+a+'" onclick="ieDownloadCalendar(\''+c(p)+"')\">"+n+"</a>";var f=encodeURI("data:text/calendar;charset=utf8,"+p);return'<a class="'+a+'" download="'+e.texts.download+'" href="'+f+'">'+n+"</a>"},ical:function(t){return this.ics(t,"icon-ical",e.texts.ical)},outlook:function(t){return this.ics(t,"icon-outlook",e.texts.outlook)}},d=function(t,e){if(t){try{if(e){var a=new Date(t.toLocaleString("en-US",{timeZone:e})),o=t.getTime()-a.getTime();return new Date(t.getTime()+o)}}catch(t){}return t}},r=function(t){try{return t?t.toISOString().replace(/-|:|\.\d+/g,""):""}catch(t){}},l=function(t,e){return new Date(t.getTime()+6e4*e)},i=function(t){return t.substr(0,t.indexOf("T"))},c=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"\\'").replace(/(\r?\n|\r)/gm,"\\n")},s=function(t){let e,a=0,o=0,n=0,d=0,r=0;return t&&(e=t.getBoundingClientRect(),a=Math.ceil(e.top+window.scrollY),o=Math.ceil(e.left+window.scrollX),n=Math.ceil(e.width),d=Math.ceil(e.height),r=Math.ceil(a+d)),{top:a,left:o,width:n,height:d,bottom:r}},u=function(t){return{ical:n.ical(t),google:n.google(t),off365:n.off365(t),outlook:n.outlook(t),outlkcom:n.outlkcom(t),yahoo:n.yahoo(t)}},m=function(t){t.options||(t.options={}),t.options.id||(t.options.id=Math.floor(1e6*Math.random())),t.options.class||(t.options.class=""),t.data||(t.data={}),t.data.start||(t.data.start=new Date),t.data.end?delete t.data.duration:t.data.duration||(t.data.duration=e.duration),t.data.duration&&(t.data.end=l(t.data.start,t.data.duration)),t.data.timezone?(t.data.tzstart=d(t.data.start,t.data.timezone),t.data.tzend=d(t.data.end,t.data.timezone)):(t.data.tzstart=t.data.start,t.data.tzend=t.data.end),t.data.title||(t.data.title=e.texts.title)},p=function(t){return void 0!==t.data&&void 0!==t.data.start&&(void 0!==t.data.end||void 0!==t.data.allday)};Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),t.ieDownloadCalendar=function(t){if(a){var o=new Blob([t],{type:"text/calendar"});window.navigator.msSaveOrOpenBlob(o,e.texts.download)}else alert(e.texts.ienoblob)},t.doAddToCalenderClick=function(t,e){var a,o,n,d,r,l=t.parentElement;if(l.matches(".open"))l.className=l.className.replace(/\s*\bopen\b/,"");else{l.className=l.className+" open",setTimeout(function(){var e=function(a){t.nextSibling.contains(a.target)&&!a.target.matches("a")||(l.className=l.className.replace(/\bopen\b/,""),document.removeEventListener("click",e))};document.addEventListener("click",e)},1);var i=document.getElementById("add-to-calendar-label-id-"+e),c=s(i),u=document.getElementById("add-to-calendar-dropdown-id-"+e),m=s(u),p=(a=document,o=window,n=a.compatMode&&"CSS1Compat"===a.compatMode?a.documentElement:a.body,d=n.clientWidth,r=n.clientHeight,o.innerWidth&&d>o.innerWidth&&(d=o.innerWidth,r=o.innerHeight),{width:d,height:r}),f=document.documentElement.scrollTop||document.body.scrollTop,g=i.currentStyle||window.getComputedStyle(i),h=parseFloat(g.marginTop||0);if(c.bottom+m.height>p.height+f){var y=c.bottom+m.height-(p.height+f);u.style.top=c.height-y+"px",u.style.left="10px"}else u.style.top=h+c.height+"px",u.style.left="0"}return!1},t.addToCalendarData=function(t){if(t||(t={}),m(t),p(t))return u(t.data);console.error("Event details missing.")},t.createCalendar=function(t){return addToCalendar(t)},t.addToCalendar=function(t){if(t||(t={}),t instanceof HTMLElement)return n={},(o=(a=t).querySelector(".start"))&&(n.start=new Date(o.textContent)),(o=a.querySelector(".end"))&&(n.end=new Date(o.textContent)),(o=a.querySelector(".duration"))&&(n.duration=1*o.textContent),(o=a.querySelector(".allday"))&&(n.allday=!0),(o=a.querySelector(".title"))&&(n.title=o.textContent),(o=a.querySelector(".description"))&&(n.description=o.textContent),(o=a.querySelector(".address"))&&(n.address=o.textContent),n.address||(o=a.querySelector(".location"))&&(n.address=o.textContent),(o=a.querySelector(".timezone"))&&(n.timezone=o.textContent),(o=a.querySelector(".icon"))&&(n.icon=o.textContent),cal=createCalendar({data:n}),cal&&a.appendChild(cal),cal;var a,o,n;if(t instanceof NodeList){var d=t.length>0;return Array.prototype.forEach.call(t,function(t){d=d&&addToCalendar(t)}),d}if(m(t),p(t))return function(t,a){var o=a.options.class,n=a.options.id,d=a.data.icon?'<i class="'+a.data.icon+'"></i>':"",r=document.createElement("div");r.innerHTML='<button class="button add-to-calendar-label" id="add-to-calendar-label-id-'+n+'" onclick="return doAddToCalenderClick(this,'+n+');">'+d+e.texts.label+"</button>";var l=document.createElement("div");return l.className="add-to-calendar-dropdown",l.id="add-to-calendar-dropdown-id-"+n,Object.keys(t).forEach(function(e){l.innerHTML+=t[e]}),r.appendChild(l),r.className="add-to-calendar-widget",void 0!==o&&(r.className+=" "+o),r.id=n,r}(u(t.data),t);console.error("Event details missing.")},document.addEventListener("DOMContentLoaded",function(t){addToCalendar(document.querySelectorAll(e.selector))})}(this);